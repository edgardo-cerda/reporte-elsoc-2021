
## Movimientos Sociales y Acciones Colectivas

### Ciclo de movilización política y estallido social

```{r}
elsoc_long_2016_2021 %>%
  filter(tipo_atricion == 1 & ola %in% c(4,5) & !c20 %in% c(-888, -999)) %>%
  mutate(c20 = factor(c20, levels = 1:12,
                      labels = c('Estudiantil', 'Laboral', 'Ambiental',
                                 'Indigena', 'Diversidad sexual', 'Provida o Antiaborto',
                                 'Antidelincuencia', 'Feminista', 'Pensiones',
                                 'Estallido social\nde Octubre 2019', 'Otro', 'Ninguno'))) %>% 
  prop(x = c20, by = ola, na.rm = TRUE) %>% 
  group_by(c20) %>% 
  mutate(orden = mean(ifelse(ola == 5, prop, NA), na.rm = TRUE)) %>% 
  sjlabelled::as_label(ola) %>%
  ggplot(aes(y = prop, x = reorder(c20, orden), 
             label = scales::percent(prop, .1))) +
  geom_line() +
  geom_point(aes(color = ola), size = 4, alpha = .75) + 
  geom_point(color = 'black', size = 4, shape = 1) + 
  geom_text_repel(size= 3) +
  theme_bw() +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0, .3)) +
  ylab(label = NULL) +
  xlab(label = NULL) + 
  scale_color_viridis_d(begin = .33, end = .66, direction = -1, option = 'viridis') +
  theme(legend.position = 'right',
        legend.title = element_blank()) + 
  coord_flip() + 
  guides(color = guide_legend(reverse = TRUE)) +
  ggtitle(label = '¿Cuál de los siguientes movimientos sociales más valora?\nSegún ola del estudio (2019-2021)')
```


La determinación entre las categorías "Progresistas" y "Conservadores" se hizo en base a la siguiente agrupación de movimientos sociales:

Progresistas: Movimiento social de apoyo a la causa estudiantil, Movimiento social de apoyo a demandas laborales, Movimiento social de grupos ambientalistas, Movimiento social de apoyo a las demandas indígena, Movimiento social de apoyo a la diversidad sexual, Movimiento feminista o de apoyo a la igualdad de género, Movimiento por el cambio al sistema de pensiones, Estallido social del 18 de Octubre de 2019

Conservador: Movimiento social provida o antiaborto, Movimiento social antidelincuencia


```{r}
elsoc_long_2016_2021 %>%
  filter(tipo_atricion == 1 & !c20 %in% c(-888, -999)) %>%
  mutate(movsoc = car::recode(c20, "1:5 = 1; 8:10 = 1; 6:7 = 2; 11:12 = 3"),
       movsoc = factor(movsoc, levels = 1:3,
                       labels = c('Mov. sociales progresistas', 'Mov. sociales conservadores', 'Ninguno'))) %>%
  dplyr::filter(!is.na(movsoc)) %>%
  prop(movsoc, by  = c(ola), na.rm = TRUE)  %>% 
  sjlabelled::as_label(ola) %>% 
  ggplot(aes(y = prop, x = ola, color = movsoc, group = movsoc,
             label = scales::percent(prop, accuracy = .1))) +
  theme_bw() + 
  geom_line() + 
  geom_point() +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0, 1)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_color_viridis_d(begin = 0, end = .5, direction = -1, option = 'viridis') +
  geom_text_repel(nudge_y = .025) +
  theme(legend.position = 'top',
        legend.title = element_blank()) + 
    ggtitle(label = 'Movimiento social que más valora, Según ola',
          subtitle = 'Movimientos sociales agrupados en 3 categorías')

```

```{r}
elsoc_long_2016_2021 %>%
  filter(tipo_atricion == 1 & muestra==1 & !c22 %in% c(-888, -999)) %>%
  prop(c22 %in% 4:5, by  = ola, na.rm = TRUE) %>%
  sjlabelled::as_label(ola) %>% 
  ggplot(aes(y = prop, x = ola, group = 1, 
             label = scales::percent(prop, accuracy = .1))) +
  theme_bw() + 
  geom_line(color = viridis(1)) +
  geom_point(color = viridis(1)) +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0, .25)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(begin = 0, end = .85, direction = -1, option = 'viridis') +
  geom_text_repel(color = viridis(1), size = 3) + 
  theme(legend.position = 'none',   
        legend.title = element_blank()) + 
  ggtitle(label = 'Participación en movimientos sociales valorados, según ola',
          subtitle = 'Porcentaje que participa Frecuentemente o Muy frecuentemente')

```


```{r}
elsoc_long_2016_2021 %>%
  filter(tipo_atricion == 1 & muestra==1 & !c22 %in% c(-888, -999) & !c20 %in% c(-888, -999)) %>%
  mutate(mov_soc = factor(car::recode(c20, "1:5 = 1; 6:7 = 2; 8:10 = 1; 11:12 = 3"),
                          levels = 1:3,
                          labels = c('Mov. sociales progresistas', 
                                     'Mov. sociales conservadores', 'Ninguno'))) %>%
  prop(c22 %in% 4:5, by  = c(ola, mov_soc), na.rm = TRUE) %>%
  sjlabelled::as_label(ola) %>%
  ggplot(aes(y = prop, x = ola, group = mov_soc, color = mov_soc,
             label = scales::percent(prop, accuracy = .1))) +
  theme_bw() + 
  geom_line() +
  geom_point() +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0,.25)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_color_viridis_d(begin = 0, end = .7, direction = -1, option = 'viridis') +
  geom_text_repel(color = viridis(1), size = 3) + 
  theme(legend.position = 'top',   
        legend.title = element_blank()) + 
  ggtitle(label = 'Participación en movimientos sociales valorados, según ola',
          subtitle = 'Porcentaje que participa Frecuentemente o Muy frecuentemente')

```





