---
editor_options: 
  markdown: 
    wrap: 72
---

# Movimientos Sociales y Acciones Colectivas


## Ciclo de movilización política y estallido social

### 1.1 ¿Cuál es el movimiento social que usted más valora de esta lista? Según ola del estudio

<!-- ### 1.1 ¿Cuál es el movimiento social que usted más valora de esta lista? Según ola del estudio  -->

```{r diseno, include=FALSE}
elsoc_diseno <- svydesign(ids = ~segmento, #muestreo por conglomerado a nivel de manzanas (segmento)
                          strata = ~estrato, #muestreo estratificado a nivel ciudad (estato)
                          weights = ~ponderador02, #ponderador de corte transversal
                          nest = TRUE,
                          data = elsoc_panel_m1)
```

```{r include=FALSE}
datos.1.1 <- data.frame((svytable(~mov + ola, elsoc_diseno, round = F))) %>%
  group_by(ola) %>% mutate(porcentaje=Freq/sum(Freq)) %>%
  filter(ola == '2019' | ola == '2021') %>%
  na.omit()
```


```{r echo=FALSE}
g1.1 <-datos.1.1 %>% 
  ggplot(aes(y = porcentaje, x = mov, fill = ola, 
             label = as.character(scales::percent(porcentaje, accuracy = .1)))) + 
  theme_bw() + 
  geom_col(position = 'dodge2') +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0,0.3)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(begin = 0, end = .85, direction = -1, option = 'viridis') +
  coord_flip() +
  theme(axis.text.x = element_text(size=rel(.9))) +
  scale_x_discrete(labels = waiver( ))

g1.1

```

### 1.2 Frecuencia de respuesta en "ninguno" ante la pregunta ¿Cuál es el movimiento social que usted más valora de esta lista? según posición política

<!-- ### 1.2 Frecuencia de respuesta en "ninguno" ante la pregunta ¿Cuál es el movimiento social que usted más valora de esta lista? según posición política  -->

```{r}
datos.1.2 <- data.frame((svytable(~mov + pos_id, elsoc_diseno, round = F))) %>%
  group_by(pos_id) %>% mutate(porcentaje=Freq/sum(Freq)) %>% 
  filter(mov == 'Ninguno') %>%
  na.omit()
```

```{r}
g1.2 <- datos.1.2 %>% 
    ggplot(aes(y = porcentaje, x = pos_id, fill = mov, 
               label = as.character(scales::percent(porcentaje, accuracy = .1)))) +
  theme_bw() + 
    geom_col() +
    scale_y_continuous(labels = scales::percent,
                       limits = c(0, 1)) +
    ylab(label = NULL) +
    xlab(label = NULL) +
    scale_fill_viridis_d(begin = 0, end = .85, direction = -1, option = 'viridis') +
    geom_text(vjust = -0.8,
              position = position_dodge(width = .9),
              size= 2.75) +
    theme(legend.position = 'none',   ## Eliminar leyenda al no ser necesaria
          legend.title = element_blank())

g1.2
```

### 1.3 Frecuencia de respuesta en "ninguno" ante la pregunta ¿Cuál es el movimiento social que usted más valora de esta lista? según posición política "No se identifica"

<!-- ### 1.3 Frecuencia de respuesta en "ninguno" ante la pregunta ¿Cuál es el movimiento social que usted más valora de esta lista? según posición política "No se identifica"  -->

```{r}
datos.1.3 <- data.frame((svytable(~mov + pos_id + ola, elsoc_diseno, round = F))) %>%
  group_by(ola) %>% mutate(porcentaje=Freq/sum(Freq)) %>%
  filter(mov == 'Ninguno') %>%
  na.omit()

```

```{r}
g1.3 <-datos.1.3 %>% 
    ggplot(aes(y = porcentaje, x = ola, fill = mov, 
               label = as.character(scales::percent(porcentaje, accuracy = .1)))) +
  theme_bw() + 
    geom_col(position = 'dodge2') +
    scale_y_continuous(labels = scales::percent,
                       limits = c(0, 0.22)) +
    ylab(label = NULL) +
    xlab(label = NULL) +
    scale_fill_viridis_d(begin = 0, end = .85, direction = -1, option = 'viridis') +
    #Agrego facer_wrap para hacer un Gráfico para cada tramo etario
    facet_wrap(datos.1.3$pos_id)+
    theme(legend.position = 'top',
          legend.title = element_blank()) 
g1.3
```

### 1.4 Frecuencia de participación en movimientos sociales, según Ola de encuesta. Porcentaje que responde A veces, Frecuentemente o Muy frecuentemente

<!-- ### 1.4 Frecuencia de participación en movimientos sociales, según Ola de encuesta. Porcentaje que responde A veces, Frecuentemente o Muy frecuentemente  -->

```{r include=FALSE}
elsoc_panel_m1$freq_part <- car::recode(as.numeric(elsoc_panel_m1$c22), recodes = "c(1,2)=1; c(3,4,5)=2; else=NA", as.factor = TRUE)

elsoc_diseno <- svydesign(ids = ~segmento, #muestreo por conglomerado a nivel de manzanas (segmento)
                          strata = ~estrato, #muestreo estratificado a nivel ciudad (estato)
                          weights = ~ponderador02, #ponderador de corte transversal
                          nest = TRUE,
                          data = elsoc_panel_m1)
```

```{r include=FALSE}
datos.1.4 <- data.frame((svytable(~freq_part + ola, elsoc_diseno, round = F))) %>%
  group_by(ola) %>% mutate(porcentaje=Freq/sum(Freq)) %>%
  filter(freq_part == '2') %>%
  na.omit()
```


```{r echo=FALSE}
g1.4 <- datos.1.4 %>% 
    ggplot(aes(y = porcentaje, x = ola, fill = freq_part, 
               label = as.character(scales::percent(porcentaje, accuracy = .1)))) +
  theme_bw() + 
    geom_col() +
    scale_y_continuous(labels = scales::percent,
                       limits = c(0, 1)) +
    ylab(label = NULL) +
    xlab(label = NULL) +
    scale_fill_viridis_d(begin = 0, end = .85, direction = -1, option = 'viridis') +
    geom_text(vjust = -0.8,
              position = position_dodge(width = .9),
              size= 2.75) +
    theme(legend.position = 'none',   ## Eliminar leyenda al no ser necesaria
          legend.title = element_blank())

g1.4
```


## Confianza en instituciones

### 1.5 Confianza en el gobierno según ola 2018, 2019 y 2021

<!-- ### 1.5 Confianza en el gobierno según ola 2018, 2019 y 2021 -->

```{r}
elsoc_panel_m1$conf_gob
elsoc_panel_m1$conf_gob <- car::recode(as.numeric(elsoc_panel_m1$c05_01), 
                                      recode = "c(1)='Nada'; 
                                      c(2)='Poca'; c(3)='Algo'; 
                                      c(4,5)='Bastante y Mucha'; 
                                      else=NA", as.factor = TRUE)
elsoc_diseno <- svydesign(ids = ~segmento, #muestreo por conglomerado a nivel de manzanas (segmento)
                          strata = ~estrato, #muestreo estratificado a nivel ciudad (estato)
                          weights = ~ponderador02, #ponderador de corte transversal
                          nest = TRUE,
                          data = elsoc_panel_m1)

```


```{r include=FALSE}
datos.1.5 <- data.frame((svytable(~conf_gob + ola, elsoc_diseno, round = F))) %>%
  group_by(ola) %>% mutate(porcentaje=Freq/sum(Freq)) %>%
  filter(ola == '2018' | ola == '2019' | ola == '2021') %>%
  na.omit()

```


```{r}
g1.5 <- datos.1.5 %>% 
  ggplot(aes(y = porcentaje, x = ola, fill = conf_gob, 
             label = as.character(scales::percent(porcentaje, accuracy = .1)))) + 
  theme_bw() + 
  geom_col(position = 'Stack') +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0, 1)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(begin = .33, end = .66, direction = -1, option = 'viridis') +
  #cambiar geom_text tal que: Stack y cambio colores
  geom_text(position = position_stack(vjust = .5),
            size= 2.75, color = rep.int(c('black', 'white', 'white', 'white'), 3)) + 
  theme(legend.position = 'top',
        legend.title = element_blank()) +
  ggtitle('Confianza en el Presidente(a) de la República cada año')

g1.5 
```

### 1.6 Confianza en el gobierno según intención de voto

<!-- ### 1.6 Confianza en el presidente según ola 2018, 2019 y 2021 -->

```{r}
elsoc_panel_m1$conf_part <- car::recode(as.numeric(elsoc_panel_m1$c05_02), 
                                      recodes = "c(1,2)='Poca y Nada';
                                      c(3)='Algo';c(4,5)='Bastante y Mucha';
                                      else=NA", as.factor = TRUE)

elsoc_panel_m1$intencion_voto <- car::recode(as.numeric(elsoc_panel_m1$c47), 
                                      recodes = "c(1)='Con toda seguridad iré a votar'; 
                                      c(2)='Quizas iré a votar'; 
                                      c(3)='Con toda seguridad no iré a votar';
                                      else=NA", as.factor = TRUE)

elsoc_diseno <- svydesign(ids = ~segmento, #muestreo por conglomerado a nivel de manzanas (segmento)
                          strata = ~estrato, #muestreo estratificado a nivel ciudad (estato)
                          weights = ~ponderador02, #ponderador de corte transversal
                          nest = TRUE,
                          data = elsoc_panel_m1)

```

```{r}
datos.1.6 <- data.frame((svytable(~conf_part + intencion_voto + ola, elsoc_diseno, round = F))) %>%
  group_by(intencion_voto) %>% mutate(porcentaje=Freq/sum(Freq)) %>%
  filter(ola == '2021') %>%
  na.omit()
```

```{r}
g1.6 <- datos.1.6 %>% 
  ggplot(aes(y = porcentaje, x = intencion_voto, fill = conf_part, 
             label = as.character(scales::percent(porcentaje, accuracy = .1)))) + 
  theme_bw() + 
  geom_col(position = 'Stack') +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0, 0.25)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(begin = .33, end = .66, direction = -1, option = 'viridis') +
  #cambiar geom_text tal que: Stack y cambio colores
  geom_text(position = position_stack(vjust = .5),
            size= 2.75, color = rep.int(c('black', 'white', 'white'), 3)) + 
  theme(legend.position = 'top',
        legend.title = element_blank()) +
  ggtitle('Confianza en el Presidente(a) de la República cada año')

g1.6 
```
### 1.7 Nada y Poca confianza en partidos políticos según identificación política el año 2021

<!-- ### 1.7 Nada y Poca confianza en partidos políticos según identificación política el año 2021-->

```{r}
datos.1.7 <- data.frame((svytable(~conf_part + pos_id + ola, elsoc_diseno, round = F))) %>%
  group_by(pos_id) %>% mutate(porcentaje=Freq/sum(Freq)) %>%
  filter(ola == '2021') %>%
  filter(conf_part == 'Poca y Nada') %>%
  na.omit()
```

```{r}
g1.7 <- datos.1.7 %>% 
    ggplot(aes(y = porcentaje, x = pos_id, fill = conf_part, 
               label = as.character(scales::percent(porcentaje, accuracy = .1)))) +
  theme_bw() + 
    geom_col() +
    scale_y_continuous(labels = scales::percent,
                       limits = c(0, 0.3)) +
    ylab(label = NULL) +
    xlab(label = NULL) +
    scale_fill_viridis_d(begin = 0, end = .85, direction = -1, option = 'viridis') +
    geom_text(vjust = -0.8,
              position = position_dodge(width = .9),
              size= 2.75) +
    theme(legend.position = 'none',   ## Eliminar leyenda al no ser necesaria
          legend.title = element_blank()) +
    ggtitle('Nada y Poca confianza en partidos políticos según identificación política el año 2021')

g1.7 
```

### 1.8 Confianza en el presidente según ola 2018, 2019 y 2021

<!-- ### 1.8 Confianza en el presidente según ola 2018, 2019 y 2021 -->

```{r}
elsoc_panel_m1$conf_pres <- car::recode(as.numeric(elsoc_panel_m1$c05_08), 
                                      recode = "c(1)='Nada'; 
                                      c(2)='Poca'; c(3)='Algo'; 
                                      c(4)='Bastante';c(5)='Mucha'; 
                                      else=NA", as.factor = TRUE) 
elsoc_diseno <- svydesign(ids = ~segmento, #muestreo por conglomerado a nivel de manzanas (segmento)
                          strata = ~estrato, #muestreo estratificado a nivel ciudad (estato)
                          weights = ~ponderador02, #ponderador de corte transversal
                          nest = TRUE,
                          data = elsoc_panel_m1)
```


```{r include=FALSE}
datos.1.8 <- data.frame((svytable(~conf_pres + ola, elsoc_diseno, round = F))) %>%
  group_by(ola) %>% mutate(porcentaje=Freq/sum(Freq)) %>%
  filter(ola == '2018' | ola == '2019' | ola == '2021') %>%
  na.omit()

```



```{r}
g1.8 <- datos.1.8 %>% 
  ggplot(aes(y = porcentaje, x = ola, fill = conf_pres, 
             label = as.character(scales::percent(porcentaje, accuracy = .1)))) + 
  theme_bw() + 
  geom_col(position = 'dodge2') +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0, 1)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(begin = 0, end = .85, direction = -1, option = 'viridis') +
  geom_text(vjust = -0.8,
            position = position_dodge(width = .9),
            size= 2.75) +
  theme(legend.position = 'top',
        legend.title = element_blank()) +
ggtitle('Confianza en el presidente según año')

g1.8
```


