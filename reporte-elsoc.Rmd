--- 
title: "Estudio Longitudinal Social de Chile"
subtitle: "Resultados longitudinales 2016-2021"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
classoption: openany
bibliography:
- book.bib
biblio-style: apalike
link-citations: yes

output:
  bookdown::gitbook:
    lib_dir: assets
    config:
      toolbar:
        position: static
  bookdown::pdf_book:
    extra_dependencies: ["flafter"]
    toc: no

geometry: "left=4cm, right=3cm, top=2.5cm, bottom=2.5cm"
fontsize: 12pt
linestretch: 1.5
toc-depth: 1
lof: True
lot: True
editor_options: 
  markdown: 
    wrap: 72
---

# Introducción

Placeholder


## Sobre COES

<!--chapter:end:index.Rmd-->


# Sobre ELSOC

Placeholder


## Descripción del estudio
## Acceso a Bases de Datos ELSOC
## Características del diseño muestral
## Características del levantamiento de datos

<!--chapter:end:02-ficha-tecnica.Rmd-->


# Atrición de la muestra

Placeholder



<!--chapter:end:03-atricion.Rmd-->


# Foco en el cambio individual

Placeholder


## Nota Explicativa 

<!--chapter:end:04-foco-cambio-long.Rmd-->

---
editor_options: 
  markdown: 
    wrap: 72
---

# Movimientos Sociales y Acciones Colectivas


## Ciclo de movilización política y estallido social

### 1.1 ¿Cuál es el movimiento social que usted más valora de esta lista? Según ola del estudio

<!-- ### 1.1 ¿Cuál es el movimiento social que usted más valora de esta lista? Según ola del estudio  -->

```{r diseno, include=FALSE}
elsoc_diseno <- survey::svydesign(ids = ~segmento, #muestreo por conglomerado a nivel de manzanas (segmento)
                          strata = ~estrato, #muestreo estratificado a nivel ciudad (estato)
                          weights = ~ponderador02, #ponderador de corte transversal
                          nest = TRUE,
                          data = elsoc_panel_m1)
```

```{r include=FALSE}
datos.1.1 <- data.frame((svytable(~mov + ola, elsoc_diseno, round = F))) %>%
  group_by(ola) %>% mutate(porcentaje=Freq/sum(Freq)) %>%
  filter(ola == '2019' | ola == '2021') %>%
  na.omit()
```


```{r echo=FALSE}
g1.1 <-datos.1.1 %>% 
  ggplot(aes(y = porcentaje, x = mov, fill = ola, 
             label = as.character(scales::percent(porcentaje, accuracy = .1)))) + 
  theme_bw() + 
  geom_col(position = 'dodge2') +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0,0.3)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(begin = 0, end = .85, direction = -1, option = 'viridis') +
  coord_flip() +
  theme(axis.text.x = element_text(size=rel(.9))) +
  scale_x_discrete(labels = waiver( ))

g1.1

```

### 1.2 Frecuencia de respuesta en "ninguno" ante la pregunta ¿Cuál es el movimiento social que usted más valora de esta lista? según posición política

<!-- ### 1.2 Frecuencia de respuesta en "ninguno" ante la pregunta ¿Cuál es el movimiento social que usted más valora de esta lista? según posición política  -->

```{r}
datos.1.2 <- data.frame((svytable(~mov + pos_id + ola, elsoc_diseno, round = F))) %>%
  group_by(pos_id, ola) %>% mutate(porcentaje=Freq/sum(Freq)) %>% 
  filter(mov == 'Ninguno') %>%
  filter(ola == '2019' | ola == '2021') %>%
  na.omit()
```

```{r}
g1.2 <-datos.1.2 %>% 
    ggplot(aes(y = porcentaje, x = pos_id, fill = mov, 
               label = as.character(scales::percent(porcentaje, accuracy = .1)))) +
  theme_bw() + 
    geom_col(position = 'dodge2') +
    scale_y_continuous(labels = scales::percent,
                       limits = c(0, 0.3)) +
    ylab(label = NULL) +
    xlab(label = NULL) +
    scale_fill_viridis_d(begin = 0, end = .85, direction = -1, option = 'viridis') +
    facet_wrap(datos.1.2$ola)+
    theme(legend.position = 'top',
          legend.title = element_blank()) 

g1.2
```

### 1.3 Frecuencia de respuesta en "ninguno" ante la pregunta ¿Cuál es el movimiento social que usted más valora de esta lista? según posición política "No se identifica"

<!-- ### 1.3 Frecuencia de respuesta en "ninguno" ante la pregunta ¿Cuál es el movimiento social que usted más valora de esta lista? según posición política "No se identifica"  -->

```{r}
datos.1.3 <- data.frame((svytable(~mov + pos_id + ola, elsoc_diseno, round = F))) %>%
  group_by(ola) %>% mutate(porcentaje=Freq/sum(Freq)) %>%
  filter(mov == 'Ninguno') %>%
  na.omit()

```

```{r}
g1.3 <-datos.1.3 %>% 
    ggplot(aes(y = porcentaje, x = ola, fill = mov, 
               label = as.character(scales::percent(porcentaje, accuracy = .1)))) +
  theme_bw() + 
    geom_col(position = 'dodge2') +
    scale_y_continuous(labels = scales::percent,
                       limits = c(0, 0.22)) +
    ylab(label = NULL) +
    xlab(label = NULL) +
    scale_fill_viridis_d(begin = 0, end = .85, direction = -1, option = 'viridis') +
    #Agrego facer_wrap para hacer un Gráfico para cada tramo etario
    facet_wrap(datos.1.3$pos_id)+
    theme(legend.position = 'top',
          legend.title = element_blank()) 
g1.3
```

### 1.4 Alluvial de movimiento social que más valora

```{r}
elsoc_panel_m1$movsoc<- car::recode(elsoc_panel_m1$c20, 
                                          "1='Progresista';2='Progresista';3='Progresista';
                                          4='Progresista';5='Progresista';6='Conservador';7='Conservador';
                                          8='Progresista';9='Progresista';10='Progresista';11=NA;12='Ninguno';
                                          c(-999,-888)=NA",as.factor=T)

datos.1.4 <- elsoc_panel_m1 %>% 
  dplyr::filter(tipo_atricion == 1) %>% 
  dplyr::filter(!is.na(movsoc)) %>%
  group_by(idencuesta) %>%
  mutate(n_obs = n()) %>%
  ungroup() %>% 
  mutate(n_ok = (n_obs == max(n_obs))) %>% 
  dplyr::filter(n_ok) %>%  # Quedarse solo con los casos con observaciones completas
  group_by(idencuesta, movsoc, ola) %>% 
  summarise(n1 = sum(ponderador02, na.rm = TRUE)) %>%
  group_by(ola) %>% 
  mutate(n2 = sum(n1, na.rm = TRUE), porcentaje = n1/n2) %>% 
  ungroup()

etiquetas.1.4 <- datos.1.4 %>% 
  group_by(movsoc, ola) %>% 
  summarise(porcentaje = sum(porcentaje, na.rm = TRUE)) %>% 
  mutate(idencuesta = 1)


```

```{r}
g1.4 <- ggplot(datos.1.4 , aes(x = ola, fill = movsoc, stratum = movsoc, 
                  alluvium = idencuesta, y = porcentaje )) +
  theme_bw() +
  ggalluvial::geom_flow(alpha = .66) + 
  ggalluvial::geom_stratum(linetype = 0) +
  scale_y_continuous(labels = scales::percent) + 
  ylab(label = NULL) +
  xlab(label = NULL) + 
  theme(legend.position = 'top',
        legend.title = element_blank()) +
  scale_fill_viridis_d(begin = 0, end = .85, direction = -1, option = 'viridis') +
  geom_text(data = etiquetas.1.4, 
            aes(label = scales::percent(porcentaje, accuracy = .1)),
            position = position_stack(vjust = .5),
            show.legend = FALSE,
            size = 2.75,
            color = c(rep('black', 5),
                      rep('black', 5),
                      rep('white', 5))) 

g1.4
```

### 1.5 Descriptivos generales

```{r}
datos.1.5 <- elsoc_panel_m1 %>% 
  dplyr::filter(tipo_atricion == 1) %>% 
  dplyr::filter(!is.na(movsoc)) %>%
  mutate(movsoc = factor(movsoc, 
                         levels = c('Progresista', 'Conservador', 'Ninguno'),
                         labels = c('Progresista', 'Conservador', 'Ninguno'))) %>% 
  group_by(movsoc, ola) %>% 
  summarise(n1 = sum(ponderador02, na.rm = TRUE)) %>% 
  group_by(ola) %>% 
  mutate(n2 = sum(n1, na.rm = TRUE), 
         porcentaje = n1/n2) %>% 
  ungroup()
```

```{r}
g1.5 <- datos.1.5 %>% 
  ggplot(aes(y = porcentaje, x = forcats::fct_rev(movsoc), fill = forcats::fct_rev(ola), 
             label = as.character(scales::percent(ifelse(porcentaje == 0, NA, porcentaje), accuracy = .1)))) +
  theme_bw() + 
  geom_col(position = 'dodge2') +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0, .8)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(begin = .33, end = .66, direction = 1, option = 'viridis') +
  geom_text(hjust = -.1,
            position = position_dodge(width = 1),
            size= 2.75) +
  theme(legend.position = 'top',
        legend.title = element_blank()) + 
  guides(fill = guide_legend(reverse = TRUE))+
  coord_flip()
g1.5
```

### 1.6 cambios de valoración de movimientos sociales segun posición política

```{r}
datos.1.6 <- elsoc_panel_m1 %>% 
  dplyr::filter(tipo_atricion == 1) %>%
  mutate(movsoc = factor(movsoc, 
                         levels = c('Progresista', 'Conservador', 'Ninguno'),
                         labels = c('Progresista', 'Conservador', 'Ninguno')),
         pos_id = factor(pos_id, 
                         levels = c('Izquierda', 'Centro', 'Derecha', 'No se identifica'),
                         labels = c('Izquierda', 'Centro', 'Derecha', 'No se\n identifica'))) %>% 
  group_by(ola, movsoc, pos_id) %>% 
  summarise(n1 = sum(ponderador02, na.rm = TRUE)) %>%
  dplyr::filter(!is.na(pos_id) & !is.na(movsoc)) %>%
  group_by(ola, pos_id) %>% 
  mutate(n2 = sum(n1, na.rm = TRUE), porcentaje = n1/n2) %>% 
  ungroup() 

```

```{r}
g1.6 <- datos.1.6 %>% 
  ggplot(aes(y = porcentaje, x = pos_id, fill =movsoc, 
             label = as.character(scales::percent(ifelse(porcentaje>.01, porcentaje, NA), accuracy = .1)))) +
  theme_bw() +
  geom_col(position = 'stack') +
  facet_grid(.~ola) +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0, 1)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(begin = 0, end = .85, direction = -1, option = 'viridis') +
  geom_text(position = position_stack(vjust = .5),
            size= 2.75,
            color = rep(c(rep('black', 4),
                          rep('white', 4),
                          rep('white', 4)),5)) + 
  theme(legend.position = 'top',
        legend.title = element_blank()) +
  ggtitle('Porcentaje de valoración de movimientos por posición política, por ola')

g1.6
```

### 1.7 segun nivel educativo

```{r}
datos.1.7 <- elsoc_panel_m1 %>% 
  dplyr::filter(tipo_atricion == 1) %>%
  mutate(movsoc = factor(movsoc, 
                         levels = c('Progresista', 'Conservador', 'Ninguno'),
                         labels = c('Progresista', 'Conservador', 'Ninguno')),
         educ = factor(educ, 
                       levels = c('Basica','Media','Tecnica','Universitaria'),
                       labels = c('Basica','Media','Tecnica','Universitaria'))) %>% 
  group_by(ola, movsoc, educ) %>% 
  summarise(n1 = sum(ponderador02, na.rm = TRUE)) %>%
  dplyr::filter(!is.na(educ) & !is.na(movsoc)) %>%
  group_by(ola, educ) %>% 
  mutate(n2 = sum(n1, na.rm = TRUE), porcentaje = n1/n2) %>% 
  ungroup() 
```

```{r}
g1.7 <- datos.1.7 %>% 
  ggplot(aes(y = porcentaje, x = educ, fill =movsoc, 
             label = as.character(scales::percent(ifelse(porcentaje>.01, porcentaje, NA), accuracy = .1)))) +
  theme_bw() +
  geom_col(position = 'stack') +
  facet_grid(.~ola) +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0, 1)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(begin = 0, end = .85, direction = -1, option = 'viridis') +
  geom_text(position = position_stack(vjust = .5),
            size= 2.75,
            color = rep(c(rep('black', 4),
                          rep('white', 4),
                          rep('white', 4)),5)) + 
  theme(legend.position = 'top',
        legend.title = element_blank()) +
  ggtitle('Porcentaje de valoración de movimientos según nivel educativo, por ola')

g1.7

#REVISAR ESTE GRAFICO NO PLOTEA PROGRESISTAS CON MEDIA PARA 2019
```

### 1.8 Valoración de mov segun segun participacion

```{r}
elsoc_panel_m1$participacion<- factor(car::recode(elsoc_panel_m1$c22, "c(1,2)='Nunca o casi nunca'; 3='A veces';
                                                        c(4,5)='Frecuente o muy frecuentemente';
                                                        c(-999,-888)=NA"),
                                            levels=c('Nunca o casi nunca', 'A veces', 'Frecuente o muy frecuentemente'))


datos.1.8 <- elsoc_panel_m1 %>% 
  dplyr::filter(tipo_atricion == 1) %>%
  mutate(movsoc = factor(movsoc, 
                         levels = c('Progresista', 'Conservador', 'Ninguno'),
                         labels = c('Progresista', 'Conservador', 'Ninguno')),
         participacion = factor(participacion, 
                                levels = c('Nunca o casi nunca', 'A veces', 'Frecuente o muy frecuentemente'),
                                labels = c('Nunca o \ncasi nunca', 'A veces', 'Frecuente o muy\n frecuentemente'))) %>% 
  group_by(ola, movsoc, participacion) %>% 
  summarise(n1 = sum(ponderador02, na.rm = TRUE)) %>%
  dplyr::filter(!is.na(participacion) & !is.na(movsoc)) %>%
  group_by(ola, participacion) %>% 
  mutate(n2 = sum(n1, na.rm = TRUE), porcentaje = n1/n2) %>% 
  ungroup() 
```

```{r}
g1.8 <- datos.1.8 %>% 
  ggplot(aes(y = porcentaje, x = participacion, fill =movsoc, 
             label = as.character(scales::percent(ifelse(porcentaje>.01, porcentaje, NA), accuracy = .1)))) +
  theme_bw() +
  geom_col(position = 'stack') +
  facet_grid(.~ola) +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0, 1)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(begin = 0, end = .85, direction = -1, option = 'viridis') +
  geom_text(position = position_stack(vjust = .5),
            size= 2.75,
            color = rep(c(rep('black', 3),
                          rep('white', 3)),5)) + 
  theme(legend.position = 'top',
        legend.title = element_blank()) +
  ggtitle('Porcentaje de valoración de movimientos segun participación del entrevistado, por ola')

g1.8
```


### 1.9 Frecuencia de participación en movimientos sociales, según Ola de encuesta. Porcentaje que responde A veces, Frecuentemente o Muy frecuentemente

<!-- ### 1.4 Frecuencia de participación en movimientos sociales, según Ola de encuesta. Porcentaje que responde A veces, Frecuentemente o Muy frecuentemente  -->

```{r include=FALSE}
elsoc_panel_m1$freq_part <- car::recode(as.numeric(elsoc_panel_m1$c22), recodes = "c(1,2)=1; c(3,4,5)=2; else=NA", as.factor = TRUE)

elsoc_diseno <- survey::svydesign(ids = ~segmento, #muestreo por conglomerado a nivel de manzanas (segmento)
                          strata = ~estrato, #muestreo estratificado a nivel ciudad (estato)
                          weights = ~ponderador02, #ponderador de corte transversal
                          nest = TRUE,
                          data = elsoc_panel_m1)
```

```{r include=FALSE}
datos.1.9 <- data.frame((svytable(~freq_part + ola, elsoc_diseno, round = F))) %>%
  group_by(ola) %>% mutate(porcentaje=Freq/sum(Freq)) %>%
  filter(freq_part == '2') %>%
  na.omit()
```


```{r echo=FALSE}
g1.9 <- datos.1.9 %>% 
    ggplot(aes(y = porcentaje, x = ola, fill = freq_part, 
               label = as.character(scales::percent(porcentaje, accuracy = .1)))) +
  theme_bw() + 
    geom_col() +
    scale_y_continuous(labels = scales::percent,
                       limits = c(0, 1)) +
    ylab(label = NULL) +
    xlab(label = NULL) +
    scale_fill_viridis_d(begin = 0, end = .85, direction = -1, option = 'viridis') +
    geom_text(vjust = -0.8,
              position = position_dodge(width = .9),
              size= 2.75) +
    theme(legend.position = 'none',   
          legend.title = element_blank())

g1.9
```


## Confianza en instituciones

### 1.10 Confianza en distintas instituciones según año

```{r}

elsoc_panel_m1$conf_part <- car::recode(as.numeric(elsoc_panel_m1$c05_02), 
                                      recodes = "c(1,2)='Nada y Poca';
                                      c(3, 4)='Algo y Bastante';
                                      else=NA", as.factor = TRUE)
elsoc_panel_m1$conf_carab <- car::recode(as.numeric(elsoc_panel_m1$c05_03), 
                                      recodes = "c(1,2)='Nada y Poca';
                                      c(3, 4)='Algo y Bastante';
                                      else=NA", as.factor = TRUE)
elsoc_panel_m1$conf_jud <- car::recode(as.numeric(elsoc_panel_m1$c05_05), 
                                      recodes = "c(1,2)='Nada y Poca';
                                      c(3, 4)='Algo y Bastante';
                                      else=NA", as.factor = TRUE)
elsoc_panel_m1$conf_cong <- car::recode(as.numeric(elsoc_panel_m1$c05_07), 
                                      recodes = "c(1,2)='Nada y Poca';
                                      c(3, 4)='Algo y Bastante';
                                      else=NA", as.factor = TRUE)
elsoc_panel_m1$conf_pres <- car::recode(as.numeric(elsoc_panel_m1$c05_08), 
                                      recode = "c(1,2)='Nada y Poca';
                                      c(3, 4)='Algo y Bastante';
                                      else=NA", as.factor = TRUE) 
elsoc_panel_m1$conf_gob <- car::recode(as.numeric(elsoc_panel_m1$c05_01), 
                                      recode = "c(1,2)='Nada y Poca';
                                      c(3, 4)='Algo y Bastante';
                                      else=NA", as.factor = TRUE)

elsoc_diseno <- survey::svydesign(ids = ~segmento, #muestreo por conglomerado a nivel de manzanas (segmento)
                          strata = ~estrato, #muestreo estratificado a nivel ciudad (estato)
                          weights = ~ponderador02, #ponderador de corte transversal
                          nest = TRUE,
                          data = elsoc_panel_m1)
```

```{r}
datos.pres <- data.frame((svytable(~conf_pres + ola, elsoc_diseno, round = F))) %>% group_by(ola) %>% mutate(p_pres=Freq/sum(Freq))
datos.pres$ola <- NULL

datos.part <- data.frame((svytable(~conf_part + ola, elsoc_diseno, round = F))) %>% group_by(ola) %>% mutate(p_part=Freq/sum(Freq))
datos.part$ola <- NULL

datos.carb <- data.frame((svytable(~conf_carab + ola, elsoc_diseno, round = F))) %>% group_by(ola) %>% mutate(p_carb=Freq/sum(Freq))
datos.carb$ola <- NULL

datos.jud <- data.frame((svytable(~conf_jud + ola, elsoc_diseno, round = F))) %>% group_by(ola) %>% mutate(p_jud=Freq/sum(Freq))
datos.jud$ola <- NULL

datos.cong <- data.frame((svytable(~conf_cong + ola, elsoc_diseno, round = F))) %>% group_by(ola) %>% mutate(p_cong=Freq/sum(Freq))
datos.cong$ola <- NULL

datos.gob <- data.frame((svytable(~conf_gob + ola, elsoc_diseno, round = F))) %>% group_by(ola) %>% mutate(p_gob=Freq/sum(Freq))

elsoc_diseno <- survey::svydesign(ids = ~segmento, #muestreo por conglomerado a nivel de manzanas (segmento)
                          strata = ~estrato, #muestreo estratificado a nivel ciudad (estato)
                          weights = ~ponderador02, #ponderador de corte transversal
                          nest = TRUE,
                          data = elsoc_panel_m1)

datos.grafico.1.10 <- cbind(datos.pres, datos.part, datos.carb, datos.jud, datos.cong, datos.gob)

#trasponer según variable
datos.1.10 <- datos.grafico.1.10 %>% 
        pivot_longer(cols = starts_with('conf_'))  %>%
        mutate(variable = factor(name,
                             labels = c('Presidente/a de la Republica', 
                                        'Partidos Políticos', 
                                        'Carabineros de Chile', 'Poder Judicial', 
                                        'Congreso Nacional', 
                                        'Gobierno de Chile'))) %>%
                              filter(value == 'Algo y Bastante') %>%
                              drop_na() 

datos.1.10$porcentaje <- with(datos.1.10, case_when(
  variable == 'Carabineros de Chile' ~ p_carb,
  variable == 'Presidente/a de la Republica' ~ p_pres,
  variable == 'Partidos Políticos' ~ p_part,
  variable == 'Poder Judicial' ~ p_jud,
  variable == 'Congreso Nacional' ~ p_cong,
  variable == 'Presidente/a de la Republica' ~ p_gob))


```

```{r}
g1.10 <- ggplot(datos.1.10, aes(y = porcentaje, x = ola, color = variable, group = variable,
               label = as.character(scales::percent(porcentaje, accuracy = .1)))) +
    theme_bw() +   
    geom_line(size = 1) +
    geom_point(size = 1.8) +
    scale_y_continuous(labels = scales::percent,
                       limits = c(0,1)) +
    ylab(label = NULL) +
    xlab(label = NULL) +
    scale_color_viridis_d(begin = 0, end = .95, direction = 1, option = 'viridis') +
    geom_text_repel(posilinetion = position_dodge(width = .9),
    size= 2.25) + 
    theme(legend.position = 'top',
          legend.title = element_blank())

g1.10
```



### 1.11 Confianza en el gobierno según ola 2018, 2019 y 2021

```{r}

elsoc_diseno <- survey::svydesign(ids = ~segmento, #muestreo por conglomerado a nivel de manzanas (segmento)
                          strata = ~estrato, #muestreo estratificado a nivel ciudad (estato)
                          weights = ~ponderador02, #ponderador de corte transversal
                          nest = TRUE,
                          data = elsoc_panel_m1)

```


```{r include=FALSE}
datos.1.11 <- data.frame((svytable(~conf_gob + ola, elsoc_diseno, round = F))) %>%
  group_by(ola) %>% mutate(porcentaje=Freq/sum(Freq)) %>%
  filter(ola == '2018' | ola == '2019' | ola == '2021') %>%
  na.omit()

```


```{r}
g1.11 <- datos.1.11 %>% 
  ggplot(aes(y = porcentaje, x = ola, fill = conf_gob, 
             label = as.character(scales::percent(porcentaje, accuracy = .1)))) + 
  theme_bw() + 
  geom_col(position = 'Stack') +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0, 1)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(begin = .33, end = .66, direction = -1, option = 'viridis') +
  #cambiar geom_text tal que: Stack y cambio colores
  geom_text(position = position_stack(vjust = .5)) + 
  theme(legend.position = 'top',
        legend.title = element_blank())

g1.11 
```

### 1.12 Confianza en el presidente según ola 2018, 2019 y 2021

```{r}
elsoc_diseno <- survey::svydesign(ids = ~segmento, #muestreo por conglomerado a nivel de manzanas (segmento)
                          strata = ~estrato, #muestreo estratificado a nivel ciudad (estato)
                          weights = ~ponderador02, #ponderador de corte transversal
                          nest = TRUE,
                          data = elsoc_panel_m1)
```


```{r include=FALSE}
datos.1.12 <- data.frame((svytable(~conf_pres + ola, elsoc_diseno, round = F))) %>%
  group_by(ola) %>% mutate(porcentaje=Freq/sum(Freq)) %>%
  filter(ola == '2018' | ola == '2019' | ola == '2021') %>%
  na.omit()

```



```{r}
g1.12 <- datos.1.12 %>% 
  ggplot(aes(y = porcentaje, x = ola, fill = conf_pres, 
             label = as.character(scales::percent(porcentaje, accuracy = .1)))) + 
  theme_bw() + 
  geom_col(position = 'Stack') +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0, 1)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(begin = .33, end = .66, direction = -1, option = 'viridis') +
  geom_text(position = position_stack(vjust = .5)) + 
  theme(legend.position = 'top',
        legend.title = element_blank())

g1.12
```



<!--chapter:end:05-mov-sociales-acc-colec.Rmd-->


# Identificación Política

Placeholder


## Identificación política
### 2.1 Identificación política por ola
### 2.2 Alluvial de cambios de Identificación política
### 2.3 Grado de acuerdo con la cuarentena según identificación política
### 2.4 Grado de acuerdo con actividad económica versus salud pública según identificación política
### 2.5 Intención de voto según identificación política

<!--chapter:end:06-id-politica.Rmd-->


# Actitudes hacia la democracia

Placeholder


## Apoyo a la Democracia
### 3.1 ¿Con cuál de las siguientes frases está usted más de acuerdo?
### 3.2 Frecuencia de respuesta "Nada satisfecho" con la democracia según ola
### 3.3 ¿Con cuál de las siguientes frases está usted más de acuerdo? (2021), según posición ideológica

<!--chapter:end:07-actitud-demo.Rmd-->


# Perfiles Ideológicos de los Chilenos 

Placeholder


## Clases latentes: Motivación
### Batería de preguntas
## Modelo teórico de perfiles ideólogicos
### Aproximación Empírica
### Perfiles ideológicos: Resultados principales

<!--chapter:end:08-perfiles-ideo.Rmd-->


# Conflicto de Clases y Élites

Placeholder


## Relaciones inter-clases
### Clases sociales y Trato Justo
## Deprivación Relativa

<!--chapter:end:09-conflicto-clases.Rmd-->


# Justificación de la Violencia

Placeholder


## Justificación de la violencia para el control social – a manos de ciudadanos
## Justificación de la violencia para el control social – a manos de carabineros

<!--chapter:end:10-just-viol.Rmd-->


# Cambio Constitucional

Placeholder


## Patrones de Votación

<!--chapter:end:11-camb-constiucional.Rmd-->


# Conflicto barrial

Placeholder



<!--chapter:end:12-territorio.Rmd-->



## Efecto aislamiento social 

<!--chapter:end:13-aisla-social.Rmd-->


# Confianza y seguridad con perspectiva territorial

Placeholder


## Confianza en vecinos
## Seguridad barrial

<!--chapter:end:14-confianza-territ.Rmd-->


# Estatus subjetivo y Percepción de Mérito

Placeholder


## Estatus subjetivo
## Percepción de meritocracia

<!--chapter:end:15-merito-desig.Rmd-->


# Género

Placeholder


## Sexismo hostil y benevolente
## Roles de Género
## Trabajo y género

<!--chapter:end:16-genero.Rmd-->


# Salud mental y bienestar

Placeholder


## Brecha de género en Salud Mental
## Sintomatología depresiva, sexo y ocupación
## COVID - 19
## Salud Mental en COVID-19

<!--chapter:end:17-salud-bienestar.Rmd-->


# Migración

Placeholder


## Amenaza realista y amenaza simbólica respecto a inmigrantes
## Amenaza realista y simbólica respecto a inmigrantes según nivel educacional

<!--chapter:end:18-migracion.Rmd-->


# Pandemia Covid-19

Placeholder


## Cuarentenas 
## Estrés Financiero

<!--chapter:end:19-pandemia-covid-19.Rmd-->

# Cómo citar este informe: {-}

:::{.blue-box}
> COES (2021) Radiografía del Cambio Social: Análisis de Resultados Longitudinales ELSOC 2016-2021. Presentación de Resultados COES. Septiembre, Santiago de Chile.
:::

**Entrada Bibtex:**

```{r,echo=TRUE,eval=FALSE}
@techreport{coes_Radiografia_2021,
  title = {Radiograf\'ia Del {{Cambio Social}}: {{An\'alisis}} de {{Resultados Longitudinales ELSOC}} 2016-2021.},
  author = {COES},
  year = {2021},
  month = sep,
  address = {{Santiago de Chile, Chile}},
  institution = {{Centro de Estudios de Conflicto y Cohesi\'on Social}}
}
```

<!--chapter:end:20-como-citar.Rmd-->

