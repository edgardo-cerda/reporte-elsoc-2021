---
editor_options: 
  markdown: 
    wrap: 72
---

# Actitudes hacia la democracia



## Apoyo a la Democracia


<!-- ### 3.1 ¿Con cuál de las siguientes frases está usted más de acuerdo? -->
```{r include=FALSE}

 
``` 



<!-- ### 3.2 ¿Cuán satisfecho o insatisfecho está usted con el funcionamiento de la democracia en Chile? -->

```{r include=FALSE}
#agregar variable a bbdd original

elsoc_panel_m1$sat_dem <- car::recode(as.numeric(elsoc_panel_m1$c01), 
                                      recodes = "c(1)='Nada satisfecho'; 
                                      c(2)='Poco satisfecho'; c(3)='Algo satisfecho'; 
                                      c(4)='Bastante satisfecho';c(5)='Muy satisfecho'; 
                                      else=NA", as.factor = TRUE) 

#volver a realizar el código de la encuesta debido a la presencia de una nueva variable
elsoc_diseno <- svydesign(ids = ~segmento, #muestreo por conglomerado a nivel de manzanas (segmento)
                          strata = ~estrato, #muestreo estratificado a nivel ciudad (estato)
                          weights = ~ponderador02, #ponderador de corte transversal
                          nest = TRUE,
                          data = elsoc_panel_m1)

#crear tabla para el gráfico
datos.grafico1 <- data.frame((svytable(~sat_dem + ola, elsoc_diseno, round = F))) %>% group_by(ola) %>% mutate(porcentaje=Freq/sum(Freq))
```


```{r include=FALSE}

graf.sat_dem <-datos.grafico1 %>% 
  ggplot(aes(y = porcentaje, x = ola, fill = sat_dem, 
             label = as.character(scales::percent(porcentaje, accuracy = .1)))) + 
  theme_bw() + 
  geom_col(position = 'Stack') +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0, 1)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(begin = .33, end = .66, direction = -1, option = 'viridis') +
  #cambiar geom_text tal que: Stack y cambio colores
  geom_text(position = position_stack(vjust = .5),
            size= 2.75, color = rep.int(c('black', 'white', 'white', 'white', 'white'), 5)) + 
  theme(legend.position = 'top',
        legend.title = element_blank())

graf.sat_dem
```




<!-- ### 3.3. ¿Con cuál de las siguientes frases está usted más de acuerdo? (2019), según posición ideológica -->

```{r include=FALSE}
elsoc_panel_m1$aut_dem <- car::recode(as.numeric(elsoc_panel_m1$c25), 
                                      recodes = "c(1)='Democracia es preferible a cualquier otra forma de gobierno'; 
                                      c(2)='En algunos casos, gobierno autoritario puede ser preferible'; c(3)='Da lo mismo régimen democrático o autoritario'; 
                                      c(4)='Ninguna'; 
                                      else=NA", as.factor = TRUE) 
elsoc_diseno <- svydesign(ids = ~segmento, #muestreo por conglomerado a nivel de manzanas (segmento)
                          strata = ~estrato, #muestreo estratificado a nivel ciudad (estato)
                          weights = ~ponderador02, #ponderador de corte transversal
                          nest = TRUE,
                          data = elsoc_panel_m1)

#crear tabla para el gráfico
datos.grafico2 <- data.frame((svytable(~aut_dem + pos_id, elsoc_diseno, round = F))) %>% group_by(pos_id) %>% mutate(porcentaje=Freq/sum(Freq))
```


```{r include=FALSE}

graf.aut_dem <-datos.grafico2 %>% 
  ggplot(aes(y = porcentaje, x = pos_id, fill = aut_dem, 
             label = as.character(scales::percent(porcentaje, accuracy = .1)))) + 
  theme_bw() + 
  geom_col(position = 'Stack') +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0, 1)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(begin = .33, end = .66, direction = -1, option = 'viridis') +
  #cambiar geom_text tal que: Stack y cambio colores
  geom_text(position = position_stack(vjust = .5),
            size= 2.75, color = rep.int(c('black', 'white', 'white', 'white'), 4)) + 
  theme(legend.position = 'top',
        legend.title = element_blank())

graf.aut_dem


```



<!-- ### 3.4 Grado de acuerdo con las siguientes afirmaciones Porcentaje que responde De acuerdo o Totalmente de acuerdo  -->
```{r include=FALSE}

```



