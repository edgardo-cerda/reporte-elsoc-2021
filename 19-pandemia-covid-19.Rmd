---
editor_options: 
  markdown: 
    wrap: 72
---

# Pandemia Covid-19

```{r}
load("1_input/elsoc_covid.RData")
```

```{r hist-fecha-2021}
datos.grafico <- data.frame((svytable(~fecha_entr + comuna_cod + ola, 
                                      elsoc_diseno_3, round = F))) %>% 
  group_by(comuna_cod, ola) %>% 
  mutate(porcentaje=Freq/sum(Freq)) %>% 
  filter(ola==2021 & Freq>0)

datos.grafico$fecha_entr<-as.Date(datos.grafico$fecha_entr)

gr.19.1 <- datos.grafico %>% 
  ggplot(mapping = aes(x = fecha_entr)) +
  theme_bw() + 
  geom_histogram(bins = 9,
                 stat="count") +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_x_date(date_breaks = "1 month", date_labels = "%d %b %Y")

gr.19.1
```

```{r hist-ccum-dens}
elsoc_covid_panel$ccum_cont <- as.numeric(as.character(elsoc_covid_panel$ccum))

gr.19.2 <- elsoc_covid_panel %>% 
  ggplot(aes(x=ccum_cont)) + 
  geom_histogram(aes(y = ..density..), bins=30) + 
  geom_density(aes(color=factor(zona1))) +
  theme_bw() +
  ylab(label = NULL) +
  xlab(label = "Tiempo (Nº de Días)")

gr.19.2
```


```{r}
gr.19.2 <- elsoc_covid_panel %>% 
  ggplot(aes(x=ccum_cont)) + 
  geom_histogram(aes(y = ..density..), bins=30) + 
  geom_density(aes(color=factor(edadt))) +
  theme_bw() +
  ylab(label = NULL) +
  xlab(label = "Tiempo (Nº de Días)")

gr.19.2
```

```{r}
elsoc_covid_panel$phq <- factor(car::recode(elsoc_covid_panel$suma_dep, "0:9=0 ; 10:27=1"), 
                                labels = c("Sin Depresión", "Con Depresión"))

gr.19.2 <- elsoc_covid_panel %>% 
  ggplot(aes(x=ccum_cont)) + 
  geom_histogram(aes(y = ..density..), bins=30) + 
  geom_density(aes(color=factor(phq))) +
  theme_bw() +
  ylab(label = NULL) +
  xlab(label = "Tiempo (Nº de Días)")

gr.19.2
```


