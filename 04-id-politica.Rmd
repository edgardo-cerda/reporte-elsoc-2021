
# Cambios sociales y políticos

## Identificación política

### Participación ciudadana e interés en política

```{r}

elsoc_long_2016_2021 %>%
  filter(tipo_atricion == 1 & !c08_02 %in% c(-888, -999) & !c08_04 %in% c(-888, -999)) %>%
  as_label(ola) %>% 
  prop_list(c08_02 %in% 4:5, c08_04 %in% 4:5, by = ola, na.rm = TRUE) %>% 
  mutate(name = factor(name,
                       levels = c('c08_02 %in% 4:5', 'c08_04 %in% 4:5'),
                       labels = c('Asiste a marcha o\nmanifestación pacífica',
                       'Usa RRSS para opinar\nen temas públicos'))) %>% 
  ggplot(aes(y = prop, x = ola, color = name, group = name,
             label = scales::percent(prop, accuracy = .1))) +
  theme_bw() + 
  geom_point() + 
  geom_line() +
  # geom_text_repel(nudge_y = .01, size = 3) +
  scale_y_continuous(labels = scales::percent, limits = c(0,.3)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_color_viridis_d(end = .66, option = 'viridis') +
  theme(legend.position = 'top',
        legend.title = element_blank()) + 
  ggtitle(label = 'Participación ciudadana, según ola del estudio')

```

```{r}

elsoc_long_2016_2021 %>%
  filter(tipo_atricion == 1 & !c13 %in% c(-888, -999) & 
           !c14_01 %in% c(-888, -999) & !c14_02 %in% c(-888, -999)) %>%
  as_label(ola) %>% 
  prop_list(c13 %in% 4:5, c14_01 %in% 4:5, c14_02 %in% 4:5, by = ola, na.rm = TRUE) %>% 
  mutate(name = factor(name, 
                       levels = c('c13 %in% 4:5', 'c14_01 %in% 4:5', 'c14_02 %in% 4:5'),
                       labels = c('Se interesa en política', 'Habla de política\ncon familiares',
                       'Se informa\nsobre política'))) %>% 
  ggplot(aes(y = prop, x = ola, color = name, group = name,
             label = scales::percent(prop, accuracy = .1))) +
  theme_bw() + 
  geom_point() + 
  geom_line() +
  geom_text(nudge_y = .025, size = 3) +
  scale_y_continuous(labels = scales::percent, limits = c(0,.6)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_color_viridis_d(end = .7, option = 'viridis') +
  theme(legend.position = 'top',
        legend.title = element_blank()) + 
  ggtitle(label = 'Interés en política, según ola del estudio')
  
```


### ¿Cómo se posicionan políticamente los chilenos?

```{r echo=FALSE}

elsoc_long_2016_2021 %>%
  filter(tipo_atricion == 1 & ola == 5 & !c15 %in% c(-888, -999)) %>%
  mutate(pos_id = factor(car::recode(c15, recodes = "0:4 = 1; 5 = 2; 6:10 = 3; 11:12 = 4"),
                         levels = 1:4,
                         labels = c('Izquierda', "Centro", "Derecha", "No se identifica"))) %>%
  prop(x = pos_id, na.rm = TRUE) %>% 
  ggplot(aes(y = prop, fill = pos_id, x = pos_id, 
             label = scales::percent(prop, accuracy = .1))) +
  theme_bw() + 
  geom_col(position= 'dodge2') +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(direction = 1, option = 'viridis') +
  geom_text(vjust = -0.5,
            position = position_dodge2(width = .9),
            size = 3) + 
  theme(legend.position = 'top',
        legend.title = element_blank()) + 
  ggtitle(label = 'Identificación política (2021)')

```



```{r echo=FALSE}

elsoc_long_2016_2021 %>%
  filter(tipo_atricion == 1 & ola == 5 & !c13 %in% c(-888, -999) & !c15 %in% c(-888, -999)) %>%
  mutate(pos_id = factor(car::recode(c15, recodes = "0:4 = 1; 5 = 2; 6:10 = 3; 11:12 = 4"),
                         levels = 1:4,
                         labels = c('Izquierda', "Centro", "Derecha", "No se identifica")),
         interes = factor(car::recode(c13, "1 = 1; 2:3 = 2; 4:5 = 3"),
                          levels = 1:3,
                          labels = c('Nada interesado/a', 'Poco o algo\ninteresado/a', 'Bastante o muy\ninteresado/a'))) %>%
  prop(x = pos_id, by = interes, na.rm = TRUE) %>% 
  ggplot(aes(y = prop, fill = fct_rev(pos_id), x = interes, 
             label = scales::percent(prop, accuracy = .1))) +
  theme_bw() + 
  geom_col(position= 'stack') +
  scale_y_continuous(labels = scales::percent) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(direction = -1, end = .85, option = 'viridis') +
  geom_text(position = position_stack(vjust = .5),
            size = 3,
            color = rep(rep(c('white', 'black'), each = 2), 3)) + 
  theme(legend.position = 'top',
        legend.title = element_blank()) + 
  guides(fill = guide_legend(reverse = TRUE)) + 
  ggtitle(label = 'Identificación política, según grado de interes en la política (2021)')

```

### Cambios en la identificación política en el período 2016-2021


Entre 2016 y 2021 la identificación con la izquierda se ha mantenido estable (25,3% en 2021), mientras que 
el centro y la derecha han aumentado su participación (de 24,8% en 2016 a 36,1% en 2021, y de 14,1% a 17,5%, respectivament), en desmedro de la no identifiación política, que disminuyó de 35,8% a 19,3%


```{r echo=FALSE}

elsoc_long_2016_2021 %>%
  filter(tipo_atricion == 1) %>%
  mutate(pos_id = factor(car::recode(c15, recodes = "0:4 = 1; 5 = 2; 6:10 = 3; 11:12 = 4; c(-888, -999) = 5"),
                         levels = c(1, 2, 3, 4, 5),
                         labels = c('Izquierda', "Centro", "Derecha", "No se identifica", "NS/NR"))) %>%
  prop(x = pos_id, by = ola, na.rm = TRUE) %>% 
  sjlabelled::as_label(ola) %>% 
  ggplot(aes(y = prop, fill = fct_rev(pos_id), x = ola, 
             label = scales::percent(prop, accuracy = .1))) +
  theme_bw() + 
  geom_col(position= 'stack') +
  scale_y_continuous(labels = scales::percent) +
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(direction = -1, option = 'viridis') +
  geom_text(position = position_stack(vjust = .5),
            size = 3,
            color = rep(c(rep('white', 3), rep('black', 2)), 5)) +
  theme(legend.position = 'top',
        legend.title = element_blank()) + 
  guides(fill = guide_legend(reverse = TRUE)) + 
  ggtitle(label = 'Identificación política, según ola del estudio')

```


Aunque los porcentajes son relativamente estables, esconden una alta fluidez en la identificación con las diferentes posiciones políticas por año


```{r}

elsoc_long_2016_2021 %>% 
  filter(tipo_atricion == 1 & ola %in% 1:5) %>% 
  mutate(pos_id = factor(car::recode(c15, "0:4 = 1; 5 = 2; 6:10 = 3; 11:12 = 4; c(-888, -999) = 5"),
                         levels = c(1, 2, 3, 4, 5),
                         labels = c('Izquierda', "Centro", "Derecha", "No se identifica", "NS/NR"))) %>%
  as_label(ola) %>% 
  survey_design_elsoc() %>%
  svytable(~pos_id + ola + idencuesta, design = .) %>% 
  as.data.frame() %>% 
  group_by(ola) %>% 
  mutate(prop = Freq/sum(Freq)) %>%
  filter(Freq > 0) %>% 
  ggplot(aes(y = prop, x = ola, fill = fct_rev(pos_id), 
             stratum = fct_rev(pos_id), alluvium = idencuesta)) +
  ggalluvial::geom_flow(alpha = .66) + 
  ggalluvial::geom_stratum(linetype = 0, width = .55) +
  scale_y_continuous(labels = scales::percent) + 
  ylab(label = NULL) +
  xlab(label = NULL) + 
  theme(legend.position = 'top',
        legend.title = element_blank()) +
  scale_fill_viridis_d(direction = -1) +
  geom_text(data = function(x) { group_by(.data = x, ola, pos_id) %>% 
      summarise(prop = sum(prop, na.rm = TRUE), idencuesta = 1) %>% 
      ungroup()}, 
            aes(label = scales::percent(prop, accuracy = .1)),
            position = position_stack(vjust = .5),
            show.legend = FALSE,
            size = 3,
            color = rep(c('white', 'white', 'white', 'black', 'black'), 5)) + 
  guides(fill = guide_legend(reverse = TRUE)) + 
  ggtitle(label = 'Cambios en la identificación política, según ola del estudio')


```


El grupo político más estable (comparando posiciones politicas entre 2016 y 2021) es el de centro: 54,0% de quienes se posicionaban políticamente de Centro, lo hicieron también en 2021. En contraste, la No identificación política es la menos estable: solo 31,3% de quienes no se identificaban políticamente en 2016, lo hicieron también en 2021. Para la izquierda y la derecha, estos porcentajes son 47,8% y 47,6%, respectivamente. 


```{r}

elsoc_wide_2016_2021 %>% 
  filter(tipo_atricion == 1) %>% 
  mutate(pos_id_w01 = factor(car::recode(c15_w01, recodes = "0:4 = 1; 5 = 2; 6:10 = 3; 11:12 = 4; c(-888, -999) = 5"),
                         levels = c(1, 2, 3, 4, 5),
                         labels = c('Izquierda', "Centro", "Derecha", "No se\nidentifica", "NS/NR")),
         pos_id_w05 = factor(car::recode(c15_w05, recodes = "0:4 = 1; 5 = 2; 6:10 = 3; 11:12 = 4; c(-888, -999) = 5"),
                         levels = c(1, 2, 3, 4, 5),
                         labels = c('Izquierda', "Centro", "Derecha", "No se\nidentifica", "NS/NR"))) %>% 
  survey_design_elsoc(weights = 'ponderador02_w05') %>% 
  prop(pos_id_w05, by = pos_id_w01) %>% 
  filter(pos_id_w01 != 'NS/NR') %>% 
  ggplot(aes(y = prop, x = pos_id_w01, fill = fct_rev(pos_id_w05),
             label = scales::percent(prop, accuracy = .1))) + 
  geom_col(position = 'stack') +
  scale_y_continuous(labels = scales::percent) +
  ylab(label = NULL) +
  xlab(label = 'Posición política en 2016') +
  scale_fill_viridis_d(direction = -1, option = 'viridis') +
  geom_text(position = position_stack(vjust = .5),
            size = 3,
            color = rep(c(rep('white', 3), rep('black', 2)), 4)) +
  theme(legend.position = 'right') +
  labs(fill = 'Posición política\nen 2021') + 
  guides(fill = guide_legend(reverse = TRUE)) + 
  ggtitle(label = 'Cambios en identificación política entre 2016 y 2021')

  
```

```{r}
elsoc_wide_2016_2021 %>% 
  filter(tipo_atricion == 1 & !c15_w01 %in% c(-888, -999) & !c15_w04 %in% c(-888, -999)) %>% 
  mutate(pos_id_w01 = factor(car::recode(c15_w01, recodes = "0:4 = 1; 5 = 2; 6:10 = 3; 11:12 = 4; c(-888, -999) = 5"),
                         levels = 1:4,
                         labels = c('Izquierda', "Centro", "Derecha", "No se\nidentifica")),
         pos_id_w05 = factor(car::recode(c15_w05, recodes = "0:4 = 1; 5 = 2; 6:10 = 3; 11:12 = 4; c(-888, -999) = 5"),
                         levels = 1:4,
                         labels = c('Izquierda', "Centro", "Derecha", "No se\nidentifica")),
         cambia = pos_id_w01 != pos_id_w05,
         edadt_w05 = factor(car::recode(m0_edad_w05, "18:29 = 1; 30:49 = 2; 50:64 = 3; 65:150 = 4"),
                        labels = c('18-29', '30-49', '50-64', '65 o más'))) %>% 
  survey_design_elsoc(weights = 'ponderador02_w05') %>% 
  prop(cambia == TRUE, by = edadt_w05, na.rm = TRUE) %>% 
  ggplot(aes(y = prop, x = edadt_w05, label = scales::percent(prop, .1))) + 
  theme_bw() +
  geom_col(fill = viridis(1, begin = .33)) +
  geom_text(position = position_dodge(.9), vjust = -.5, size = 3) +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) + 
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(begin = .33, end = .66, option = 'viridis') +
  theme(legend.position = 'top') +
  ggtitle(label = 'Cambios en identificación política, según grupo etáreo',
          subtitle = 'Porcentaje que cambia su identififación política entre 2016 y 2021' )

```


```{r}
elsoc_wide_2016_2021 %>% 
  filter(tipo_atricion == 1 & !c15_w01 %in% c(-888, -999) & !c15_w04 %in% c(-888, -999) & 
           !d01_01_w05 %in% c(-888, -999, NA)) %>% 
  mutate(pos_id_w01 = factor(car::recode(c15_w01, recodes = "0:4 = 1; 5 = 2; 6:10 = 3; 11:12 = 4; c(-888, -999) = 5"),
                         levels = 1:4,
                         labels = c('Izquierda', "Centro", "Derecha", "No se\nidentifica")),
         pos_id_w05 = factor(car::recode(c15_w05, recodes = "0:4 = 1; 5 = 2; 6:10 = 3; 11:12 = 4; c(-888, -999) = 5"),
                         levels = 1:4,
                         labels = c('Izquierda', "Centro", "Derecha", "No se\nidentifica")),
         cambia = pos_id_w01 != pos_id_w05,
         clase_sub = factor(car::recode(d01_01_w05, "0:4 = 1; 5 = 2; 6:10 = 3; else = NA"), 
                            levels = 1:3, 
                            labels = c("Baja y media baja", "Media", "Alta y media alta"))) %>%
  survey_design_elsoc(weights = 'ponderador02_w05') %>% 
  prop(cambia == TRUE, by = clase_sub, na.rm = TRUE) %>% 
  ggplot(aes(y = prop, x = clase_sub, label = scales::percent(prop, .1))) + 
  theme_bw() +
  geom_col(fill = viridis(1, begin = .33)) +
  geom_text(position = position_dodge(.9), vjust = -.5, size = 3) +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) + 
  ylab(label = NULL) +
  xlab(label = NULL) +
  scale_fill_viridis_d(begin = .33, end = .66, option = 'viridis') +
  theme(legend.position = 'top') +
  ggtitle(label = 'Cambios en identificación política, según clase social subjetiva',
          subtitle = 'Porcentaje que cambia su identififación política entre 2016 y 2021' )

```


### Opinión en temas de discusión pública

```{r}

elsoc_long_2016_2021 %>%
  filter(tipo_atricion == 1 & ola %in% 4:5 & !c15 %in% c(-888, -999) & 
           !c37_02 %in% c(-888, -999) & 
           !c37_04 %in% c(-888, -999) & 
           !c37_05 %in% c(-888, -999)) %>% 
  as_label(ola) %>% 
  mutate(pos_id = factor(car::recode(c15, recodes = "0:4 = 1; 5 = 2; 6:10 = 3; 11:12 = 4"),
                         levels = c(1, 2, 3, 4),
                         labels = c('Izquierda', "Centro", "Derecha", "No se\nidentifica"))) %>% 
  prop_list(c37_02 %in% 4:5, c37_04 %in% 4:5, c37_05 %in% 4:5, 
            by = c(ola, pos_id), na.rm = TRUE) %>% 
  mutate(name = factor(name, 
                       levels = c('c37_02 %in% 4:5', 'c37_04 %in% 4:5', 'c37_05 %in% 4:5'),
                       labels = c('Aborto debe ser legal\nbajo cualquier circunstancia',
                                  'Cada persona debiera\nasegurar su propia pensión', 
                                  'Se deberían tomar medidas más\ndrásticas para evitar inmigración'))) %>% 
  ggplot(aes(x = pos_id, y = prop, 
             label = scales::percent(prop, .1))) +
  facet_wrap(.~name) +
  geom_line() +
  geom_point(aes(color = ola), size = 4, alpha = .66) + 
  geom_point(color = 'black', size = 4, shape = 1) + 
  geom_text_repel(size= 3, nudge_x = .05, nudge_y = .033) +
  theme_bw() +
  scale_y_continuous(labels = scales::percent,
                     limits = c(0, 1)) +
  ylab(label = NULL) +
  xlab(label = NULL) + 
  ggtitle('Acuerdo con temas de discusión pública, según posición política (2019-2021)',
        subtitle = 'Porcentaje que responde de acuerdo o muy de acuerdo') +
  scale_color_viridis_d(begin = .33, end = .66, direction = -1, option = 'viridis') +
  theme(legend.position = 'top',
        legend.title = element_blank()) 

    
```